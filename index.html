<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Happy Valentine's Day - ‡∏Å‡∏≠‡∏ü & ‡∏ó‡∏£‡∏≤‡∏¢</title>
    <link href="https://fonts.googleapis.com/css2?family=Mali:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #ffffff;
            --accent-pink: #ff4d6d;
        }

        body {
            margin: 0; padding: 0;
            background: var(--bg-color);
            overflow: hidden;
            font-family: 'Mali', cursive; 
            width: 100vw; height: 100dvh; touch-action: none; position: fixed; color: #333;
        }

        canvas {
            display: block; position: absolute; top: 0; left: 0; 
            z-index: 1; width: 100%; height: 100%;
            filter: saturate(1.8) contrast(1.2);
        }

        #start-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #fff; z-index: 999; display: flex; justify-content: center; align-items: center; 
            flex-direction: column; cursor: pointer; transition: opacity 0.8s ease;
        }
        
        .start-btn {
            padding: 15px 40px; border-radius: 50px;
            background: #ff6a88; color: #fff; font-size: 1.3rem; font-weight: 600;
            box-shadow: 0 10px 20px rgba(255, 106, 136, 0.3); border: none;
        }

        #name-container {
            position: absolute; top: 12%; left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10; opacity: 0; text-align: center; width: 100%;
            transition: all 1s ease;
        }
        #name-container.visible { opacity: 1; }
        .glowing-text { font-size: 2.5rem; color: #ff4d6d; margin: 0; }

        #love-timer-container {
            margin-top: 10px; background: rgba(255, 77, 109, 0.1);
            padding: 8px 15px; border-radius: 20px; display: inline-block;
        }
        .timer-highlight { font-weight: 700; color: #ff4d6d; }

        #puzzle-wrapper {
            position: absolute; top: 55%; left: 50%; transform: translate(-50%, -50%);
            z-index: 100; opacity: 0; pointer-events: none; transition: opacity 0.5s;
            background: #fff; padding: 15px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        #puzzle-wrapper.active { opacity: 1; pointer-events: auto; }
        #puzzle-board { display: grid; grid-template-columns: repeat(3, 1fr); gap: 2px; width: 240px; height: 300px; background: #eee; }
        .puzzle-piece { background-image: url('photo1.jpg'); background-size: 240px 300px; cursor: pointer; border: 0.5px solid #fff; }
        .puzzle-piece.selected { outline: 3px solid #ff4d6d; z-index: 10; transform: scale(0.95); }

        #content-box {
            position: absolute; bottom: 0; left: 0; width: 100%; max-height: 75vh;
            z-index: 200; display: none; flex-direction: column; align-items: center;
            padding: 30px 0; background: #ffffff; border-radius: 35px 35px 0 0;
            box-shadow: 0 -10px 30px rgba(0,0,0,0.05); overflow-y: auto;
        }
        #content-box.visible { display: flex; animation: slideUp 1s forwards; }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

        .photo-frame {
            background: #fff; padding: 10px 10px 35px 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            width: 160px; height: 200px; transform: rotate(-2deg); margin: 15px 0; cursor: pointer;
        }
        .couple-photo { width: 100%; height: 100%; object-fit: cover; transition: opacity 0.3s ease; }

        .love-note-btn {
            background: linear-gradient(135deg, #ff9a9e 0%, #ff6a88 100%);
            border: none; border-radius: 30px; color: #fff; padding: 12px 30px;
            font-family: 'Mali', cursive; font-size: 1.1rem; cursor: pointer; margin-top: 10px;
        }

        #note-popup {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: white; padding: 25px; border-radius: 20px; z-index: 300;
            display: none; text-align: center; width: 250px; border: 3px solid #ff9a9e;
        }
        .beating-heart { display: inline-block; animation: heartbeat 1.5s infinite; color: #ff4d6d; }
        @keyframes heartbeat { 0%, 100% {transform: scale(1);} 50% {transform: scale(1.2);} }
    </style>
</head>
<body>
    <audio id="bg-music" loop><source src="song.mp3" type="audio/mpeg"></audio>
    <div id="start-screen" onclick="startShow()">
        <div class="start-btn">‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç üéÅ</div>
    </div>
    <canvas id="canvas"></canvas>
    <div id="name-container">
        <h1 class="glowing-text">‡∏Å‡∏≠‡∏ü üíó ‡∏ó‡∏£‡∏≤‡∏¢</h1>
        <div id="love-timer-container">
            <span id="love-timer">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì...</span>
        </div>
    </div>
    <div id="puzzle-wrapper">
        <p style="text-align:center; margin-top:0;">‡∏ï‡πà‡∏≠‡∏à‡∏¥‡πä‡∏Å‡∏ã‡∏≠‡∏ß‡πå‡∏£‡∏π‡∏õ‡πÄ‡∏£‡∏≤‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ô‡∏∞ üß©</p>
        <div id="puzzle-board"></div>
    </div>
    <div id="content-box">
        <h2 style="color:#ff4d6d; margin:0;">Happy Valentine's Day üåπ</h2>
        <p style="text-align:center; color:#666; margin:10px 20px;">‡∏£‡∏±‡∏Å‡πÄ‡∏ó‡∏≠‡∏ô‡∏∞‚ù§Ô∏è<br>‡∏õ‡∏µ 2026 ‡∏ô‡∏µ‡πâ‡∏Å‡πá‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ó‡∏≠‡∏Ñ‡∏ô‡πÄ‡∏î‡∏¥‡∏° <span class="beating-heart">‚ù§Ô∏è</span></p>
        <div class="photo-frame" onclick="nextPhoto()">
            <img src="photo1.jpg" id="main-img" class="couple-photo">
        </div>
        <p id="photo-hint" style="font-size: 0.8rem; color: #999;">‡πÅ‡∏ï‡∏∞‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏π‡∏õ‡∏≠‡∏∑‡πà‡∏ô‡πÜ (1/3)</p>
        <button class="love-note-btn" onclick="showNote()">üíå ‡∏Å‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏¥‡∏î‡∏ñ‡∏∂‡∏á</button>
    </div>
    <div id="note-popup" onclick="this.style.display='none'">
        <div id="note-text" style="font-weight:600; color:#ff6a88; font-size:1.2rem;"></div>
        <p style="font-size:0.7rem; color:#ccc; margin-top:10px;">(‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏¥‡∏î)</p>
    </div>

    <script>
        const startDate = new Date("2019-03-10T00:00:00");
        const photoList = ['photo1.jpg', 'photo2.jpg', 'photo3.jpg'];
        const notes = ["‡πÄ‡∏ó‡∏≠‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å‡∏ô‡∏∞ ‡∏£‡∏π‡πâ‡∏°‡∏±‡πâ‡∏¢", "‡∏£‡∏±‡∏Å‡πÄ‡∏ó‡∏≠‡∏ô‡∏£‡πâ‡∏≤", "‡∏™‡∏π‡πâ‡πÜ", "special person", "‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô"];
        let currentPhotoIndex = 0, currentNoteIndex = 0, mode = 0;
        const canvas = document.getElementById("canvas"), ctx = canvas.getContext("2d");
        let particles = [], rockets = [];

        function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
        window.addEventListener('resize', resize); resize();

        function nextPhoto() {
            const img = document.getElementById('main-img');
            currentPhotoIndex = (currentPhotoIndex + 1) % photoList.length;
            img.style.opacity = '0';
            setTimeout(() => {
                img.src = photoList[currentPhotoIndex];
                img.onload = () => {
                    img.style.opacity = '1';
                    document.getElementById('photo-hint').innerText = `‡πÅ‡∏ï‡∏∞‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏π‡∏õ‡∏≠‡∏∑‡πà‡∏ô‡πÜ (${currentPhotoIndex+1}/3)`;
                };
            }, 250);
        }

        function updateTimer() {
            const diff = new Date() - startDate;
            const d = Math.floor(diff / 86400000), h = Math.floor((diff / 3600000) % 24), m = Math.floor((diff / 60000) % 60), s = Math.floor((diff / 1000) % 60);
            document.getElementById('love-timer').innerHTML = `‡πÄ‡∏£‡∏≤‡∏£‡∏±‡∏Å‡∏Å‡∏±‡∏ô‡∏°‡∏≤ <span class="timer-highlight">${d}</span> ‡∏ß‡∏±‡∏ô ${h} ‡∏ä‡∏°. ${m} ‡∏ô‡∏≤‡∏ó‡∏µ ${s} ‡∏ß‡∏¥`;
        }
        setInterval(updateTimer, 1000);

        // --- ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏•‡∏∏‡πÉ‡∏´‡∏°‡πà ---
        class Rocket {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = canvas.height;
                this.targetY = Math.random() * (canvas.height * 0.4);
                this.speed = Math.random() * 3 + 5;
                this.hue = Math.random() * 360;
                this.trail = [];
            }
            update() {
                this.trail.push({x: this.x, y: this.y});
                if(this.trail.length > 10) this.trail.shift();
                this.y -= this.speed;
                if(this.y <= this.targetY) {
                    createHeartBurst(this.x, this.y, this.hue);
                    return false;
                }
                return true;
            }
            draw() {
                ctx.beginPath();
                ctx.strokeStyle = `hsl(${this.hue}, 100%, 70%)`;
                ctx.lineWidth = 2;
                this.trail.forEach((p, i) => {
                    ctx.globalAlpha = i / 10;
                    ctx.lineTo(p.x, p.y);
                });
                ctx.stroke();
                ctx.globalAlpha = 1;
            }
        }

        function createHeartBurst(x, y, hue) {
            for (let i = 0; i < 75; i++) {
                const t = (i / 75) * Math.PI * 2;
                const tx = 16 * Math.pow(Math.sin(t), 3), ty = -(13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t));
                particles.push({ x, y, hue, vx: tx * 0.28, vy: ty * 0.28, alpha: 1, decay: 0.012 });
            }
        }

        function loop() {
            requestAnimationFrame(loop);
            ctx.fillStyle = 'rgba(255, 255, 255, 0.25)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            rockets = rockets.filter(r => { r.draw(); return r.update(); });
            particles.forEach((p, i) => {
                p.x += p.vx; p.y += p.vy; p.vy += 0.04; p.alpha -= p.decay;
                ctx.fillStyle = `hsla(${p.hue}, 100%, 50%, ${p.alpha})`;
                ctx.beginPath(); ctx.arc(p.x, p.y, 2, 0, 6.28); ctx.fill();
                if(p.alpha <= 0) particles.splice(i, 1);
            });

            if(mode === 1 && Math.random() < 0.03) rockets.push(new Rocket());
        }

        function startShow() {
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('bg-music').play();
            mode = 1; loop();
            setTimeout(() => {
                document.getElementById('name-container').classList.add('visible');
                initPuzzle();
            }, 2000);
        }

        function initPuzzle() {
            const wrapper = document.getElementById('puzzle-wrapper'), board = document.getElementById('puzzle-board');
            wrapper.classList.add('active');
            let indices = [0,1,2,3,4,5,6,7,8].sort(() => Math.random() - 0.5);
            indices.forEach((idx) => {
                const piece = document.createElement('div');
                piece.className = 'puzzle-piece';
                piece.style.backgroundPosition = `-${(idx%3)*80}px -${Math.floor(idx/3)*100}px`;
                piece.dataset.idx = idx;
                piece.onclick = function() {
                    if(window.selected) {
                        let tIdx = this.dataset.idx, tBg = this.style.backgroundPosition;
                        this.dataset.idx = window.selected.dataset.idx; this.style.backgroundPosition = window.selected.style.backgroundPosition;
                        window.selected.dataset.idx = tIdx; window.selected.style.backgroundPosition = tBg;
                        window.selected.classList.remove('selected'); window.selected = null;
                        if(Array.from(board.children).every((p, i) => parseInt(p.dataset.idx) === i)) {
                            wrapper.classList.remove('active');
                            setTimeout(() => { wrapper.style.display = 'none'; document.getElementById('content-box').classList.add('visible'); }, 500);
                        }
                    } else { this.classList.add('selected'); window.selected = this; }
                };
                board.appendChild(piece);
            });
        }

        function showNote() {
            const p = document.getElementById('note-popup');
            document.getElementById('note-text').innerText = notes[currentNoteIndex];
            p.style.display = 'block';
            currentNoteIndex = (currentNoteIndex + 1) % notes.length;
        }
    </script>
</body>
</html>
